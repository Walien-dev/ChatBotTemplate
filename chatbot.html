<link href="https://fonts.googleapis.com/css?family=Raleway:500:600|Roboto&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.css">
<link rel="stylesheet" href="chatbot.css">

<div id="chat-app" class="chat-app">
  
  <div class="chat-app_toggle toggle">
    <div class="icon send">
      <i class="fas fa-paper-plane"></i>
    </div>
    <div class="icon open">
      <i class="fas fa-comment"></i>
    </div>
  </div>
  
  <div class="chat-app_box">
    <div class="chat-app_header">
      
      <div class="close"></div>
      
      <div class="branding">
        <div class="avatar is-online">
          <img src="https://image.freepik.com/vecteurs-libre/icone-robot-conception-signe-bot-notion-symbole-chatbot-service-assistance-vocale-bot-support-ligne-bot-stock-illustration-vectorielle_100456-34.jpg" alt="">
        </div>
        
        <div class="content">
          <p class="title">ChatBot</p>
          <p class="subtitle">Ask me anything, I am here to help you.</p>
        </div>
        
      </div>
    
    </div>
    
    <div class="chat-app_content">
      <div class="messages">
        
        <div class="message">
          <p class="text">Message user</p>
        </div>
        
        <div class="message reply">
          <p class="text">Message from bot</p>
        </div>
        
        
      </div>
    </div>
    
    <div class="chat-app_footer">
      <input class="chat-input" type="text" placeholder="Type..." />
    </div>
    
  </div>
</div>


<script>
  function chatInit(selector) {
  document.addEventListener('DOMContentLoaded', () => {
    if (!window.LIVE_CHAT_UI) {
      let chat = document.querySelector(selector);
      let toggles = chat.querySelectorAll('.toggle')
      let close = chat.querySelector('.close')
      let send = chat.querySelector('.send')
      
      toggles.forEach( toggle => {
        toggle.addEventListener('click', () => {
          chat.classList.add('is-active')
        })
      })
      
      send.addEventListener('click', () => {
        sendMessage()
      })
      
      close.addEventListener('click', () => {
        chat.classList.remove('is-active')
      })
      
      document.onkeydown = function(evt) {
          evt = evt || window.event;
          
          var isEscape = false;
          if ("key" in evt) {
              isEscape = (evt.key === "Escape" || evt.key === "Esc");
          } else {
              isEscape = (evt.keyCode === 27);
          }
          if (isEscape) {
              chat.classList.remove('is-active')
          }


          var isEnter = false;
          if ("key" in evt) {
            isEnter = (evt.key === "Enter" || evt.key === "Etr");
          } else {
            isEnter = (evt.keyCode === 13);
          }
          if (isEnter) {
            sendMessage()
          }

          
      };
      
      window.LIVE_CHAT_UI = true
    }
  })
}

chatInit('#chat-app')


function sendMessage() {
    msg = document.getElementsByClassName('chat-input')[0].value
    if(msg != "") {
        Template = '<div class="message"><p class="text">Xmsg</p></div>'
        document.getElementsByClassName('messages')[0].innerHTML = document.getElementsByClassName('messages')[0].innerHTML + Template.replace('Xmsg', msg)
        document.getElementsByClassName('chat-input')[0].value = ""
    }
    document.getElementsByClassName('chat-app_content')[0].scrollTop = document.getElementsByClassName('messages')[0].offsetHeight
}



</script>
